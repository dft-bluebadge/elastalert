name: No_successful_payments_for_30_mins
description: 'Logging from the payment service suggests that the successful payment callbacks from GOV.UK Pay have stopped.'
type: flatline
index: filebeat-*
threshold: 1
use_count_query: true
doc_type: doc
timeframe:
  minutes: 30
realert:
  minutes: 10
exponential_realert:
  minutes: 60
filter:
- query:
    query_string:
      query: "beat.name:payment AND logger:uk.gov.dft.bluebadge.service.payment.repository.mapper.PaymentMapper.updatePayment AND message:success"
alert:
 - slack
slack:
slack_webhook_url: "https://hooks.slack.com/services/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"
match_enhancements:
- "elastalert_modules.bbworkingweek.BBWorkingWeek"
